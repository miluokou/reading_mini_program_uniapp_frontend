{"version":3,"sources":["webpack:////Users/matsuko/Downloads/ThorUI-uni-vip/components/thorui/tui-image-cropper/tui-image-cropper.vue?3ccd","webpack:////Users/matsuko/Downloads/ThorUI-uni-vip/components/thorui/tui-image-cropper/tui-image-cropper.vue?575c","webpack:////Users/matsuko/Downloads/ThorUI-uni-vip/components/thorui/tui-image-cropper/tui-image-cropper.vue?eb71","webpack:////Users/matsuko/Downloads/ThorUI-uni-vip/components/thorui/tui-image-cropper/tui-image-cropper.vue?6757","uni-app:///components/thorui/tui-image-cropper/tui-image-cropper.vue","webpack:////Users/matsuko/Downloads/ThorUI-uni-vip/components/thorui/tui-image-cropper/tui-image-cropper.vue?04cd","webpack:////Users/matsuko/Downloads/ThorUI-uni-vip/components/thorui/tui-image-cropper/tui-image-cropper.vue?2561"],"names":["name","emits","props","imageUrl","type","default","height","width","minWidth","minHeight","maxWidth","maxHeight","borderColor","edgeColor","edgeWidth","edgeBorderWidth","edgeOffsets","lockWidth","lockHeight","lockRatio","scaleRatio","quality","rotateAngle","minScale","maxScale","disableRotate","limitMove","custom","startCutting","isBase64","loadding","rotateImg","fileType","data","MOVE_THROTTLE","MOVE_THROTTLE_FLAG","TIME_CUT_CENTER","CROPPER_WIDTH","CROPPER_HEIGHT","CUT_START","cutX","cutY","touchRelative","x","y","flagCutTouch","hypotenuseLength","flagEndTouch","canvasWidth","canvasHeight","imgWidth","imgHeight","scale","angle","cutAnimation","cutAnimationTime","imgTop","imgLeft","ctx","sysInfo","computed","imgTransform","watch","uni","src","success","fail","clearTimeout","mounted","setTimeout","methods","getLocalImage","url","resolve","reject","getImage","title","icon","xpos","ypos","imgUrl","destWidth","destHeight","base64","canvasId","params","console","draw","setCutCenter","imageReset","imageLoad","cutDetectionPosition","cutDetectionPositionLeft","cutDetectionPositionTop","imgMarginDetectionPosition","left","top","imgMarginDetectionScale","imgComputeSize","computeCutSize","start","moveThrottle","move","hypotenuse","current_deg","second_deg","end","cutTouchMove","size_correct","size_inspect","cutTouchStart","corner","cutTouchEnd","moveStop","moveDuring","showLoading","mask","stop","back","setAngle"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA0I;AAC1I;AACqE;AACL;AACqC;;;AAGrG;AACgN;AAChN,gBAAgB,iNAAU;AAC1B,EAAE,uFAAM;AACR,EAAE,wGAAM;AACR,EAAE,iHAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,4GAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAA+0B,CAAgB,+yBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACkDn2B;AACA;AACA;AACA;AACA;AACA;AALA,eAMA;EACAA;EACAC;EACAC;IACA;IACAC;MACAC;MACAC;IACA;IACA;AACA;AACA;AACA;IACAC;MACAF;MACAC;IACA;IACA;IACAE;MACAH;MACAC;IACA;IACA;IACAG;MACAJ;MACAC;IACA;IACA;IACAI;MACAL;MACAC;IACA;IACA;IACAK;MACAN;MACAC;IACA;IACA;IACAM;MACAP;MACAC;IACA;IACA;IACAO;MACAR;MACAC;IACA;IACA;IACAQ;MACAT;MACAC;IACA;IACA;IACAS;MACAV;MACAC;IACA;IACA;IACAU;MACAX;MACAC;IACA;IACA;IACAW;MACAZ;MACAC;IACA;IACA;AACA;AACA;AACA;IACAY;MACAb;MACAC;IACA;IACA;IACAa;MACAd;MACAC;IACA;IACA;IACAc;MACAf;MACAC;IACA;IACA;;IAEAe;MACAhB;MACAC;IACA;IAQA;IACAgB;MACAjB;MACAC;IACA;IACA;IACAiB;MACAlB;MACAC;IACA;IACA;IACAkB;MACAnB;MACAC;IACA;IACA;IACAmB;MACApB;MACAC;IACA;IACA;IACAoB;MACArB;MACAC;IACA;IACA;IACAqB;MACAtB;MACAC;IACA;IACA;IACAsB;MACAvB;MACAC;IACA;IACA;IACAuB;MACAxB;MACAC;IACA;IACA;AACA;AACA;AACA;IACAwB;MACAzB;MACAC;IACA;IACA;IACAyB;MACA1B;MACAC;IACA;IACA;IACA0B;MACA3B;MACAC;IACA;IACA;IACA2B;MACA5B;MACAC;IACA;EACA;EACA4B;IACA;MACAC;MAAA;MACAC;MAAA;MACAC;MACAC;MAAA;MACAC;MAAA;MACAC;MACAC;MAAA;MACAC;MAAA;MACAC;QACAC;QACAC;MACA;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MACAC;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MACAC;MAAA;MACAC;MAAA;MACAC;MACAC;IACA;EACA;EACAC;IACAC;MACA;IACA;EACA;EACAC;IACA3D;MAAA;MACA;MACA;MACA4D;QACAC;QACAC;UACA;UACA;UACA;YACA;YACA;UACA;QACA;QACAC;UACA;UACA;YACA;UACA;QACA;MACA;IACA;IACA;IACAlB;MACA;QACA;MACA;MACA;IACA;IACAC;MACA;QACA;MACA;MACA;IACA;IACA3B;MACA;MACA;IACA;IACA+B;MACA;MACA;QACA;MACA;MACA;IACA;IACAC;MAAA;MACA;MACAa;MACA;QACA;UACA;QACA;MACA;IACA;IACAzC;MACA;QACA;UACA;QACA;QACA;MACA;IACA;IACAe;MACA;IACA;IACAD;MACA;IACA;IACAZ;MACA;QACA;MACA;IACA;EACA;EACAwC;IAAA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACAC;MACA;IACA;EACA;EACAC;IACA;IACAC;MAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA,OACA;kBACAR;oBACAS;oBACAP;sBACAQ;oBACA;oBACAP;sBACAQ;oBACA;kBACA;gBACA;cAAA;gBAAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IACA;IACAC;MAAA;MACA;QACAZ;UACAa;UACAC;QACA;QACA;MACA;MACA;MACA;QAAA;UAAA;UAAA;YAAA;cAAA;gBAAA;kBACA;kBACA3B;kBACAC,iEACA;kBACA2B;kBACAC,oCACA;kBACA;kBACA;kBACAC;kBAAA,KAEA;oBAAA;oBAAA;kBAAA;kBAAA;kBAAA,OACA;gBAAA;kBAAAA;gBAAA;kBAGA;kBACA;oBACA;sBACAzE;sBACAD;sBAOA2E;sBACAC;sBAGAlD;sBACAX;oBACA;oBACA;sBACAmD;sBACAW;sBACA5E;sBACAD;oBACA;oBAoCA;oBAIA;sBACAyD;wBACAqB;wBACAzC;wBACAC;wBACArC;wBACAD;wBACA2D;0BACA;0BACA;0BACAhC;0BACA;0BACA;wBACA;sBACA;oBACA;sBACA8B,yDACAsB;wBACAD;wBACAnB;0BACAhC;0BAIA;0BACA;wBACA;wBACAiC;0BACAoB;wBACA;sBAAA,IAEA,OACA;oBACA;kBAEA;gBAAA;gBAAA;kBAAA;cAAA;YAAA;UAAA;QAAA,CACA;QAAA,gBAnHAC;UAAA;QAAA;MAAA,GAmHA;MACA;QACA;QACA;QACA;QACA;UACAlB;YACAkB;UACA;QACA;MACA;QACAA;MACA;IACA;IACA;AACA;AACA;IACAC;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IACAC;MACA;MACA3B;MACA;IACA;IACA;IACA4B;MAAA;MACA;UACA;UACA;YACA;UACA;UACA;YACA;UACA;QACA;QACAC;UACA;UACA;YACA;UACA;UACA;YACA;UACA;QACA;MACA;MACA;QACA;QACA;QACA;QACA;MACA;QACAC;QACAD;MACA;QACAC;QACA;MACA;QACAD;QACA;MACA;IACA;IACA;AACA;AACA;IACAE;MACA;MACA;MACA;MACA1C;MACA;MACA;MACA;QACAF;QACAC;MACA;MACA4C;MACAA,6FACA/C,cACAE;MACA8C;MACAA,4FACA/C,eACAE;MACA;MACA;MACA;IACA;IACA;AACA;AACA;IACA8C;MACA;MACA7C;MACA;MACA;MACA;QACAF;QACAC;MACA;MACA;QACAC;MACA;MACA;QACAA;MACA;MACA;IACA;IACA;AACA;AACA;IACA8C;MACA;MACA;QACA/C;MACA;QACA;UACAA;UACAD;QACA;UACAA;UACAC;QACA;MACA;QACA;QACAD;QACAC;MACA;MACA;MACA;IACA;IACA;IACAgD;MACA;QACA;MACA;QACA;MACA;MACA;QACA;MACA;QACA;MACA;IACA;IACA;IACAC;MACA;MACA;QACA;QACA;UACAzD;UACAC;QACA;MACA;QACA;QACA;QACA;QACA;UACAD;UACAC;QACA,GACA;UACAD;UACAC;QACA,EACA;QACA;MACA;IACA;IACAyD;MAAA;MACA;QACAlC;QACA;UACA;QACA;QACA;MACA;QACA;MACA;IACA;IACAmC;MACA;MACA;MACA;MACA;MACA;QACA;QACA;UACAN;QACA;QACA;QACA;QACA;MACA;QACA;QACA;UACA1F;UACAiG;UACAnD;UACAoD;QACApD;QACAA;QACA;QACA;QACA;QACA;QACA;UACAT;UACAC;QACA,GACA;UACAD;UACAC;QACA,EACA;QACA;UACA;UACA,+FACAD;UACA;UACA,gGACAA;UACA;UACA;YACA8D;UACA;YACAD;UACA;YACAA;UACA;QACA;QACA;QACA;QACA;QACA;QACA;MACA;IACA;IACA;IACAE;MACA;MACA;IACA;IACA;IACAC;MAAA;MACA;QACA;QACA;QACA;QACA;QACA;UACArG;UACAmC;UACAD;UACAoE;YACArG,+FACAG;YACAJ,sGACAK;UACA;UACAkG;YACA,wGACApG,cACA;cACAmG;cACA;YACA;cACAA;cACA;YACA;UACA;QACAtG,sGACA,eACAsC;QACA;UACA;YACArC;YACA;cACAD;YACA;YACA;YACA;UACA;YACAC;YACA;cACAD;YACA;YACA;YACAmC;YACA;UACA;YACAlC;YACA;cACAD;YACA;YACA;YACAmC;YACAD;YACA;UACA;YACAjC;YACA;cACAD;YACA;YACA;YACAkC;YACA;UACA;YACA;QAAA;QAEA;UACA;UACA;UACA;UACA;QACA;UACA;UACA;QACA;UACA;UACA;QACA;QACA;MACA;IACA;IACAsE;MACA;MACA;;MAEA;AACA;AACA;AACA;AACA;AACA;AACA;MACA;MACA;MAEA;MACA;MAEA;MACA;MAEA;MACA;MAEA;QACA;QACA;QACA;QACA;UACAvG;UACAD;UACAqC;UACAC;UACAmE;QACA;MACA;QACA;QACA;QACA;QACA;UACAxG;UACAD;UACAqC;UACAC;UACAH;UACAD;UACAuE;QACA;MACA;QACA;QACA;QACA;QACA;UACAxG;UACAD;UACAmC;UACAD;UACAG;UACAC;UACAmE;QACA;MACA;QACA;QACA;QACA;QACA;UACAxG;UACAD;UACAmC;UACAD;UACAG;UACAC;UACAmE;QACA;MACA;IACA;IACAC;MACA;MACA;IACA;IACA;IACAC;MAAA;MACA;MACA9C;MACA;QACA;QACA;UACA;QACA;QACA;MACA;IACA;IACA;IACA+C;MACA;MACA/C;IACA;IACAgD;MACApD;QAEAqD;QAEAxC;MACA;IACA;IACAyC;IACAC;MACAvD;IACA;IACAwD;MACA;MACA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;AC56BA;AAAA;AAAA;AAAA;AAAotC,CAAgB,ooCAAG,EAAC,C;;;;;;;;;;;ACAxuC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"components/thorui/tui-image-cropper/tui-image-cropper.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./tui-image-cropper.vue?vue&type=template&id=080e3b74&scoped=true&\"\nvar renderjs\nimport script from \"./tui-image-cropper.vue?vue&type=script&lang=js&\"\nexport * from \"./tui-image-cropper.vue?vue&type=script&lang=js&\"\nimport style0 from \"./tui-image-cropper.vue?vue&type=style&index=0&id=080e3b74&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"080e3b74\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"components/thorui/tui-image-cropper/tui-image-cropper.vue\"\nexport default component.exports","export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./tui-image-cropper.vue?vue&type=template&id=080e3b74&scoped=true&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./tui-image-cropper.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./tui-image-cropper.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"tui-container\" @touchmove.stop.prevent=\"stop\">\r\n\t\t<view class=\"tui-image-cropper\" @touchend=\"cutTouchEnd\" @touchstart=\"cutTouchStart\" @touchmove=\"cutTouchMove\">\r\n\t\t\t<view class=\"tui-content\">\r\n\t\t\t\t<view class=\"tui-content-top tui-bg-transparent\"\r\n\t\t\t\t\t:style=\"{ height: cutY + 'px', transitionProperty: cutAnimation ? '' : 'background' }\"></view>\r\n\t\t\t\t<view class=\"tui-content-middle\" :style=\"{ height: canvasHeight + 'px' }\">\r\n\t\t\t\t\t<view class=\"tui-bg-transparent\"\r\n\t\t\t\t\t\t:style=\"{ width: cutX + 'px', transitionProperty: cutAnimation ? '' : 'background' }\"></view>\r\n\t\t\t\t\t<view class=\"tui-cropper-box\"\r\n\t\t\t\t\t\t:style=\"{ width: canvasWidth + 'px', height: canvasHeight + 'px', borderColor: borderColor, transitionProperty: cutAnimation ? '' : 'background' }\">\r\n\t\t\t\t\t\t<view v-for=\"(item, index) in 4\" :key=\"index\" class=\"tui-edge\"\r\n\t\t\t\t\t\t\t:class=\"[`tui-${index < 2 ? 'top' : 'bottom'}-${index === 0 || index === 2 ? 'left' : 'right'}`]\"\r\n\t\t\t\t\t\t\t:style=\"{\r\n\t\t\t\t\t\t\t\twidth: edgeWidth,\r\n\t\t\t\t\t\t\t\theight: edgeWidth,\r\n\t\t\t\t\t\t\t\tborderColor: edgeColor,\r\n\t\t\t\t\t\t\t\tborderWidth: edgeBorderWidth,\r\n\t\t\t\t\t\t\t\tleft: index === 0 || index === 2 ? `-${edgeOffsets}` : 'auto',\r\n\t\t\t\t\t\t\t\tright: index === 1 || index === 3 ? `-${edgeOffsets}` : 'auto',\r\n\t\t\t\t\t\t\t\ttop: index < 2 ? `-${edgeOffsets}` : 'auto',\r\n\t\t\t\t\t\t\t\tbottom: index > 1 ? `-${edgeOffsets}` : 'auto'\r\n\t\t\t\t\t\t\t}\"></view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"tui-flex-auto tui-bg-transparent\"\r\n\t\t\t\t\t\t:style=\"{ transitionProperty: cutAnimation ? '' : 'background' }\"></view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"tui-flex-auto tui-bg-transparent\"\r\n\t\t\t\t\t:style=\"{ transitionProperty: cutAnimation ? '' : 'background' }\"></view>\r\n\t\t\t</view>\r\n\t\t\t<image @load=\"imageLoad\" @error=\"imageLoad\" @touchstart=\"start\" @touchmove=\"move\" @touchend=\"end\" :style=\"{\r\n\t\t\t\t\twidth: imgWidth ? imgWidth + 'px' : 'auto',\r\n\t\t\t\t\theight: imgHeight ? imgHeight + 'px' : 'auto',\r\n\t\t\t\t\ttransform: imgTransform,\r\n\t\t\t\t\ttransitionDuration: (cutAnimation ? 0.35 : 0) + 's'\r\n\t\t\t\t}\" class=\"tui-cropper-image\" :class=\"{'tui-cropper__image-hidden':!imageUrl}\" :src=\"imageUrl\" mode=\"widthFix\">\r\n\t\t\t</image>\r\n\t\t</view>\r\n\t\t<canvas canvas-id=\"tui-image-cropper\" id=\"tui-image-cropper\" :disable-scroll=\"true\"\r\n\t\t\t:style=\"{ width: CROPPER_WIDTH * scaleRatio + 'px', height: CROPPER_HEIGHT * scaleRatio + 'px' }\"\r\n\t\t\tclass=\"tui-cropper-canvas\"></canvas>\r\n\t\t<view class=\"tui-cropper-tabbar\" v-if=\"!custom\">\r\n\t\t\t<view class=\"tui-op-btn\" @tap.stop=\"back\">取消</view>\r\n\t\t\t<image :src=\"rotateImg\" class=\"tui-rotate-img\" @tap=\"setAngle\"></image>\r\n\t\t\t<view class=\"tui-op-btn\" @tap.stop=\"getImage\">完成</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\t/**\r\n\t * 注意：组件中使用的图片地址，将文件复制到自己项目中\r\n\t * 如果图片位置与组件同级，编译成小程序时图片会丢失\r\n\t * 拷贝static下整个components文件夹\r\n\t *也可直接转成base64（不建议）\r\n\t * */\r\n\texport default {\r\n\t\tname: 'tuiImageCropper',\r\n\t\temits: ['ready', 'cropper', 'imageLoad'],\r\n\t\tprops: {\r\n\t\t\t//图片路径\r\n\t\t\timageUrl: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: ''\r\n\t\t\t},\r\n\t\t\t/*\r\n\t\t\t\t 默认正方形，可修改大小控制比例\r\n\t\t\t\t 裁剪框高度 px\r\n\t\t\t\t*/\r\n\t\t\theight: {\r\n\t\t\t\ttype: Number,\r\n\t\t\t\tdefault: 280\r\n\t\t\t},\r\n\t\t\t//裁剪框宽度 px\r\n\t\t\twidth: {\r\n\t\t\t\ttype: Number,\r\n\t\t\t\tdefault: 280\r\n\t\t\t},\r\n\t\t\t//裁剪框最小宽度 px\r\n\t\t\tminWidth: {\r\n\t\t\t\ttype: Number,\r\n\t\t\t\tdefault: 100\r\n\t\t\t},\r\n\t\t\t//裁剪框最小高度 px\r\n\t\t\tminHeight: {\r\n\t\t\t\ttype: Number,\r\n\t\t\t\tdefault: 100\r\n\t\t\t},\r\n\t\t\t//裁剪框最大宽度 px\r\n\t\t\tmaxWidth: {\r\n\t\t\t\ttype: Number,\r\n\t\t\t\tdefault: 360\r\n\t\t\t},\r\n\t\t\t//裁剪框最大高度 px\r\n\t\t\tmaxHeight: {\r\n\t\t\t\ttype: Number,\r\n\t\t\t\tdefault: 360\r\n\t\t\t},\r\n\t\t\t//裁剪框border颜色\r\n\t\t\tborderColor: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: 'rgba(255,255,255,0.1)'\r\n\t\t\t},\r\n\t\t\t//裁剪框边缘线颜色\r\n\t\t\tedgeColor: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: '#FFFFFF'\r\n\t\t\t},\r\n\t\t\t//裁剪框边缘线宽度 w=h\r\n\t\t\tedgeWidth: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: '34rpx'\r\n\t\t\t},\r\n\t\t\t//裁剪框边缘线border宽度\r\n\t\t\tedgeBorderWidth: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: '6rpx'\r\n\t\t\t},\r\n\t\t\t//偏移距离，根据edgeBorderWidth进行调整\r\n\t\t\tedgeOffsets: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: '6rpx'\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 如果宽度和高度都为true则裁剪框禁止拖动\r\n\t\t\t * 裁剪框宽度锁定\r\n\t\t\t */\r\n\t\t\tlockWidth: {\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: false\r\n\t\t\t},\r\n\t\t\t//裁剪框高度锁定\r\n\t\t\tlockHeight: {\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: false\r\n\t\t\t},\r\n\t\t\t//锁定裁剪框比例（放大或缩小）\r\n\t\t\tlockRatio: {\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: false\r\n\t\t\t},\r\n\t\t\t//生成的图片尺寸相对剪裁框的比例\r\n\t\t\t// #ifndef MP-QQ\r\n\t\t\tscaleRatio: {\r\n\t\t\t\ttype: [Number, String],\r\n\t\t\t\tdefault: 2\r\n\t\t\t},\r\n\t\t\t// #endif\r\n\t\t\t// #ifdef MP-QQ\r\n\t\t\tscaleRatio: {\r\n\t\t\t\ttype: [Number, String],\r\n\t\t\t\tdefault: 3\r\n\t\t\t},\r\n\t\t\t// #endif\r\n\t\t\t//图片的质量，取值范围为 (0, 1]，不在范围内时当作1.0处理\r\n\t\t\tquality: {\r\n\t\t\t\ttype: Number,\r\n\t\t\t\tdefault: 0.8\r\n\t\t\t},\r\n\t\t\t//图片旋转角度\r\n\t\t\trotateAngle: {\r\n\t\t\t\ttype: Number,\r\n\t\t\t\tdefault: 0\r\n\t\t\t},\r\n\t\t\t//图片最小缩放比\r\n\t\t\tminScale: {\r\n\t\t\t\ttype: Number,\r\n\t\t\t\tdefault: 0.5\r\n\t\t\t},\r\n\t\t\t//图片最大缩放比\r\n\t\t\tmaxScale: {\r\n\t\t\t\ttype: Number,\r\n\t\t\t\tdefault: 2\r\n\t\t\t},\r\n\t\t\t//是否禁用触摸旋转（为false则可以触摸转动图片，limitMove为false生效）\r\n\t\t\tdisableRotate: {\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: true\r\n\t\t\t},\r\n\t\t\t//是否限制移动范围(剪裁框只能在图片内,为true不可触摸转动图片)\r\n\t\t\tlimitMove: {\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: true\r\n\t\t\t},\r\n\t\t\t//自定义操作栏（为true时隐藏底部操作栏）\r\n\t\t\tcustom: {\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: false\r\n\t\t\t},\r\n\t\t\t//值发生改变开始裁剪（custom为true时生效）\r\n\t\t\tstartCutting: {\r\n\t\t\t\ttype: [Number, Boolean],\r\n\t\t\t\tdefault: 0\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 是否返回base64(H5端默认base64)\r\n\t\t\t * 支持平台：App，微信小程序，支付宝小程序,H5(默认url就是base64)\r\n\t\t\t **/\r\n\t\t\tisBase64: {\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: false\r\n\t\t\t},\r\n\t\t\t//裁剪时是否显示loadding\r\n\t\t\tloadding: {\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: true\r\n\t\t\t},\r\n\t\t\t//旋转icon\r\n\t\t\trotateImg: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: '/static/components/cropper/img_rotate.png'\r\n\t\t\t},\r\n\t\t\t//裁剪后图片类型：jpg/png\r\n\t\t\tfileType: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: 'png'\r\n\t\t\t}\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tMOVE_THROTTLE: null, //触摸移动节流setTimeout\r\n\t\t\t\tMOVE_THROTTLE_FLAG: true, //节流标识\r\n\t\t\t\tTIME_CUT_CENTER: null,\r\n\t\t\t\tCROPPER_WIDTH: 200, //裁剪框宽\r\n\t\t\t\tCROPPER_HEIGHT: 200, //裁剪框高\r\n\t\t\t\tCUT_START: null,\r\n\t\t\t\tcutX: 0, //画布x轴起点\r\n\t\t\t\tcutY: 0, //画布y轴起点0\r\n\t\t\t\ttouchRelative: [{\r\n\t\t\t\t\tx: 0,\r\n\t\t\t\t\ty: 0\r\n\t\t\t\t}], //手指或鼠标和图片中心的相对位置\r\n\t\t\t\tflagCutTouch: false, //是否是拖动裁剪框\r\n\t\t\t\thypotenuseLength: 0, //双指触摸时斜边长度\r\n\t\t\t\tflagEndTouch: false, //是否结束触摸\r\n\t\t\t\tcanvasWidth: 0,\r\n\t\t\t\tcanvasHeight: 0,\r\n\t\t\t\timgWidth: 0, //图片宽度\r\n\t\t\t\timgHeight: 0, //图片高度\r\n\t\t\t\tscale: 1, //图片缩放比\r\n\t\t\t\tangle: 0, //图片旋转角度\r\n\t\t\t\tcutAnimation: false, //是否开启图片和裁剪框过渡\r\n\t\t\t\tcutAnimationTime: null,\r\n\t\t\t\timgTop: 0, //图片上边距\r\n\t\t\t\timgLeft: 0, //图片左边距\r\n\t\t\t\tctx: null,\r\n\t\t\t\tsysInfo: null\r\n\t\t\t};\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\timgTransform: function() {\r\n\t\t\t\treturn `translate3d(${this.imgLeft - this.imgWidth / 2}px,${this.imgTop - this.imgHeight / 2}px,0) scale(${this.scale}) rotate(${this.angle}deg)`;\r\n\t\t\t}\r\n\t\t},\r\n\t\twatch: {\r\n\t\t\timageUrl(val, oldVal) {\r\n\t\t\t\tthis.imageReset();\r\n\t\t\t\tthis.showLoading();\r\n\t\t\t\tuni.getImageInfo({\r\n\t\t\t\t\tsrc: val,\r\n\t\t\t\t\tsuccess: res => {\r\n\t\t\t\t\t\t//计算图片尺寸\r\n\t\t\t\t\t\tthis.imgComputeSize(res.width, res.height);\r\n\t\t\t\t\t\tif (this.limitMove) {\r\n\t\t\t\t\t\t\t//限制移动，不留空白处理\r\n\t\t\t\t\t\t\tthis.imgMarginDetectionScale();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: err => {\r\n\t\t\t\t\t\tthis.imgComputeSize();\r\n\t\t\t\t\t\tif (this.limitMove) {\r\n\t\t\t\t\t\t\tthis.imgMarginDetectionScale();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t//监听截取框宽高变化\r\n\t\t\tcanvasWidth(val) {\r\n\t\t\t\tif (val < this.minWidth) {\r\n\t\t\t\t\tthis.canvasWidth = this.minWidth;\r\n\t\t\t\t}\r\n\t\t\t\tthis.computeCutSize();\r\n\t\t\t},\r\n\t\t\tcanvasHeight(val) {\r\n\t\t\t\tif (val < this.minHeight) {\r\n\t\t\t\t\tthis.canvasHeight = this.minHeight;\r\n\t\t\t\t}\r\n\t\t\t\tthis.computeCutSize();\r\n\t\t\t},\r\n\t\t\trotateAngle(val) {\r\n\t\t\t\tthis.cutAnimation = true;\r\n\t\t\t\tthis.angle = val;\r\n\t\t\t},\r\n\t\t\tangle(val) {\r\n\t\t\t\tthis.moveStop();\r\n\t\t\t\tif (this.limitMove && val % 90) {\r\n\t\t\t\t\tthis.angle = Math.round(val / 90) * 90;\r\n\t\t\t\t}\r\n\t\t\t\tthis.imgMarginDetectionScale();\r\n\t\t\t},\r\n\t\t\tcutAnimation(val) {\r\n\t\t\t\t//开启过渡260毫秒之后自动关闭\r\n\t\t\t\tclearTimeout(this.cutAnimationTime);\r\n\t\t\t\tif (val) {\r\n\t\t\t\t\tthis.cutAnimationTime = setTimeout(() => {\r\n\t\t\t\t\t\tthis.cutAnimation = false;\r\n\t\t\t\t\t}, 260);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tlimitMove(val) {\r\n\t\t\t\tif (val) {\r\n\t\t\t\t\tif (this.angle % 90) {\r\n\t\t\t\t\t\tthis.angle = Math.round(this.angle / 90) * 90;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.imgMarginDetectionScale();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcutY(value) {\r\n\t\t\t\tthis.cutDetectionPosition();\r\n\t\t\t},\r\n\t\t\tcutX(value) {\r\n\t\t\t\tthis.cutDetectionPosition();\r\n\t\t\t},\r\n\t\t\tstartCutting(val) {\r\n\t\t\t\tif (this.custom && val) {\r\n\t\t\t\t\tthis.getImage();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\tthis.sysInfo = uni.getSystemInfoSync();\r\n\t\t\tthis.imgTop = this.sysInfo.windowHeight / 2;\r\n\t\t\tthis.imgLeft = this.sysInfo.windowWidth / 2;\r\n\t\t\tthis.CROPPER_WIDTH = this.width;\r\n\t\t\tthis.CROPPER_HEIGHT = this.height;\r\n\t\t\tthis.canvasHeight = this.height;\r\n\t\t\tthis.canvasWidth = this.width;\r\n\t\t\tthis.ctx = uni.createCanvasContext('tui-image-cropper', this);\r\n\t\t\tthis.setCutCenter();\r\n\t\t\t//设置裁剪框大小>设置图片尺寸>绘制canvas\r\n\t\t\tthis.computeCutSize();\r\n\t\t\t//检查裁剪框是否在范围内\r\n\t\t\tthis.cutDetectionPosition();\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthis.$emit('ready', {});\r\n\t\t\t}, 200);\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t//网络图片转成本地文件[同步执行]\r\n\t\t\tasync getLocalImage(url) {\r\n\t\t\t\treturn await new Promise((resolve, reject) => {\r\n\t\t\t\t\tuni.downloadFile({\r\n\t\t\t\t\t\turl: url,\r\n\t\t\t\t\t\tsuccess: res => {\r\n\t\t\t\t\t\t\tresolve(res.tempFilePath);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfail: res => {\r\n\t\t\t\t\t\t\treject(false)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t//返回裁剪后图片信息\r\n\t\t\tgetImage() {\r\n\t\t\t\tif (!this.imageUrl) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '请选择图片',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tthis.loadding && this.showLoading();\r\n\t\t\t\tlet draw = async () => {\r\n\t\t\t\t\t//图片实际大小\r\n\t\t\t\t\tlet imgWidth = this.imgWidth * this.scale * this.scaleRatio;\r\n\t\t\t\t\tlet imgHeight = this.imgHeight * this.scale * this.scaleRatio;\r\n\t\t\t\t\t//canvas和图片的相对距离\r\n\t\t\t\t\tlet xpos = this.imgLeft - this.cutX;\r\n\t\t\t\t\tlet ypos = this.imgTop - this.cutY;\r\n\t\t\t\t\t//旋转画布\r\n\t\t\t\t\tthis.ctx.translate(xpos * this.scaleRatio, ypos * this.scaleRatio);\r\n\t\t\t\t\tthis.ctx.rotate((this.angle * Math.PI) / 180);\r\n\t\t\t\t\tlet imgUrl = this.imageUrl;\r\n\t\t\t\t\t// #ifdef APP-PLUS || MP-WEIXIN\r\n\t\t\t\t\tif (~this.imageUrl.indexOf('https:')) {\r\n\t\t\t\t\t\timgUrl = await this.getLocalImage(this.imageUrl)\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// #endif\r\n\t\t\t\t\tthis.ctx.drawImage(imgUrl, -imgWidth / 2, -imgHeight / 2, imgWidth, imgHeight);\r\n\t\t\t\t\tthis.ctx.draw(false, () => {\r\n\t\t\t\t\t\tlet params = {\r\n\t\t\t\t\t\t\twidth: this.canvasWidth * this.scaleRatio,\r\n\t\t\t\t\t\t\theight: Math.round(this.canvasHeight * this.scaleRatio),\r\n\t\t\t\t\t\t\t// #ifdef MP-QQ\r\n\t\t\t\t\t\t\tdestWidth: this.canvasWidth * this.scaleRatio * 2,\r\n\t\t\t\t\t\t\tdestHeight: Math.round(this.canvasHeight) * this.scaleRatio * 2,\r\n\t\t\t\t\t\t\t// #endif\r\n\r\n\t\t\t\t\t\t\t// #ifndef MP-QQ\r\n\t\t\t\t\t\t\tdestWidth: this.canvasWidth * this.scaleRatio,\r\n\t\t\t\t\t\t\tdestHeight: Math.round(this.canvasHeight) * this.scaleRatio,\r\n\t\t\t\t\t\t\t// #endif\r\n\r\n\t\t\t\t\t\t\tfileType: this.fileType || 'png',\r\n\t\t\t\t\t\t\tquality: this.quality\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tlet data = {\r\n\t\t\t\t\t\t\turl: '',\r\n\t\t\t\t\t\t\tbase64: '',\r\n\t\t\t\t\t\t\twidth: this.canvasWidth * this.scaleRatio,\r\n\t\t\t\t\t\t\theight: this.canvasHeight * this.scaleRatio\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\t// #ifdef MP-ALIPAY\r\n\r\n\t\t\t\t\t\tif (this.isBase64) {\r\n\t\t\t\t\t\t\tthis.ctx.toDataURL(params).then(dataURL => {\r\n\t\t\t\t\t\t\t\tdata.base64 = dataURL;\r\n\t\t\t\t\t\t\t\tthis.loadding && uni.hideLoading();\r\n\t\t\t\t\t\t\t\tthis.ctx.rotate(((360 - this.angle % 360) * Math\r\n\t\t\t\t\t\t\t\t\t.PI) / 180);\r\n\t\t\t\t\t\t\t\tthis.ctx.translate(-xpos * this.scaleRatio, -\r\n\t\t\t\t\t\t\t\t\typos * this.scaleRatio);\r\n\t\t\t\t\t\t\t\tthis.ctx.clearRect(0, 0, this.canvasWidth * this\r\n\t\t\t\t\t\t\t\t\t.scaleRatio, this.canvasHeight * this.scaleRatio);\r\n\t\t\t\t\t\t\t\tthis.ctx.draw();\r\n\t\t\t\t\t\t\t\tthis.$emit('cropper', data);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.ctx.toTempFilePath({\r\n\t\t\t\t\t\t\t\t...params,\r\n\t\t\t\t\t\t\t\tsuccess: res => {\r\n\t\t\t\t\t\t\t\t\tdata.url = res.apFilePath;\r\n\t\t\t\t\t\t\t\t\tthis.loadding && uni.hideLoading();\r\n\t\t\t\t\t\t\t\t\tthis.ctx.rotate(((360 - this.angle % 360) * Math\r\n\t\t\t\t\t\t\t\t\t\t.PI) / 180);\r\n\t\t\t\t\t\t\t\t\tthis.ctx.translate(-xpos * this.scaleRatio, -\r\n\t\t\t\t\t\t\t\t\t\typos * this.scaleRatio);\r\n\t\t\t\t\t\t\t\t\tthis.ctx.clearRect(0, 0, this.canvasWidth * this\r\n\t\t\t\t\t\t\t\t\t\t.scaleRatio, this.canvasHeight * this.scaleRatio);\r\n\t\t\t\t\t\t\t\t\tthis.ctx.draw();\r\n\t\t\t\t\t\t\t\t\tthis.$emit('cropper', data);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// #endif\r\n\r\n\t\t\t\t\t\t// #ifndef MP-ALIPAY\n\t\t\t\t\t\tlet isBase64=this.isBase64\r\n\t\t\t\t\t\t// #ifdef MP-BAIDU || MP-TOUTIAO || H5\r\n\t\t\t\t\t\tisBase64 = false;\r\n\t\t\t\t\t\t// #endif\r\n\t\t\t\t\t\tif (isBase64) {\r\n\t\t\t\t\t\t\tuni.canvasGetImageData({\r\n\t\t\t\t\t\t\t\tcanvasId: 'tui-image-cropper',\r\n\t\t\t\t\t\t\t\tx: 0,\r\n\t\t\t\t\t\t\t\ty: 0,\r\n\t\t\t\t\t\t\t\twidth: this.canvasWidth * this.scaleRatio,\r\n\t\t\t\t\t\t\t\theight: Math.round(this.canvasHeight * this.scaleRatio),\r\n\t\t\t\t\t\t\t\tsuccess: res => {\r\n\t\t\t\t\t\t\t\t\tconst arrayBuffer = new Uint8Array(res.data);\r\n\t\t\t\t\t\t\t\t\tconst base64 = uni.arrayBufferToBase64(arrayBuffer);\r\n\t\t\t\t\t\t\t\t\tdata.base64 = base64;\r\n\t\t\t\t\t\t\t\t\tthis.loadding && uni.hideLoading();\r\n\t\t\t\t\t\t\t\t\tthis.$emit('cropper', data);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}, this);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tuni.canvasToTempFilePath({\r\n\t\t\t\t\t\t\t\t\t...params,\r\n\t\t\t\t\t\t\t\t\tcanvasId: 'tui-image-cropper',\r\n\t\t\t\t\t\t\t\t\tsuccess: res => {\r\n\t\t\t\t\t\t\t\t\t\tdata.url = res.tempFilePath;\r\n\t\t\t\t\t\t\t\t\t\t// #ifdef H5\r\n\t\t\t\t\t\t\t\t\t\tdata.base64 = res.tempFilePath;\r\n\t\t\t\t\t\t\t\t\t\t// #endif\r\n\t\t\t\t\t\t\t\t\t\tthis.loadding && uni.hideLoading();\r\n\t\t\t\t\t\t\t\t\t\tthis.$emit('cropper', data);\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tfail(res) {\r\n\t\t\t\t\t\t\t\t\t\tconsole.log(res);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tthis\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// #endif\r\n\t\t\t\t\t});\r\n\t\t\t\t};\r\n\t\t\t\tif (this.CROPPER_WIDTH != this.canvasWidth || this.CROPPER_HEIGHT != this.canvasHeight) {\r\n\t\t\t\t\tthis.CROPPER_WIDTH = this.canvasWidth;\r\n\t\t\t\t\tthis.CROPPER_HEIGHT = this.canvasHeight;\r\n\t\t\t\t\tthis.ctx.draw();\r\n\t\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\tdraw();\r\n\t\t\t\t\t\t}, 100);\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tdraw();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 设置剪裁框和图片居中\r\n\t\t\t */\r\n\t\t\tsetCutCenter() {\r\n\t\t\t\tlet sys = this.sysInfo || uni.getSystemInfoSync();\r\n\t\t\t\tlet cutY = (sys.windowHeight - this.canvasHeight) * 0.5;\r\n\t\t\t\tlet cutX = (sys.windowWidth - this.canvasWidth) * 0.5;\r\n\t\t\t\t//顺序不能变\r\n\t\t\t\tthis.imgTop = this.imgTop - this.cutY + cutY;\r\n\t\t\t\tthis.cutY = cutY; //截取的框上边距\r\n\t\t\t\tthis.imgLeft = this.imgLeft - this.cutX + cutX;\r\n\t\t\t\tthis.cutX = cutX; //截取的框左边距\r\n\t\t\t},\r\n\t\t\timageReset() {\r\n\t\t\t\t// this.cutAnimation = true;\r\n\t\t\t\tthis.scale = 1;\r\n\t\t\t\tthis.angle = 0;\r\n\t\t\t\tlet sys = this.sysInfo || uni.getSystemInfoSync();\r\n\t\t\t\tthis.imgTop = sys.windowHeight / 2;\r\n\t\t\t\tthis.imgLeft = sys.windowWidth / 2;\r\n\t\t\t},\r\n\t\t\timageLoad(e) {\r\n\t\t\t\tthis.imageReset();\r\n\t\t\t\tuni.hideLoading();\r\n\t\t\t\tthis.$emit('imageLoad', {});\r\n\t\t\t},\r\n\t\t\t//检测剪裁框位置是否在允许的范围内(屏幕内)\r\n\t\t\tcutDetectionPosition() {\r\n\t\t\t\tlet cutDetectionPositionTop = () => {\r\n\t\t\t\t\t\t//检测上边距是否在范围内\r\n\t\t\t\t\t\tif (this.cutY < 0) {\r\n\t\t\t\t\t\t\tthis.cutY = 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (this.cutY > this.sysInfo.windowHeight - this.canvasHeight) {\r\n\t\t\t\t\t\t\tthis.cutY = this.sysInfo.windowHeight - this.canvasHeight;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcutDetectionPositionLeft = () => {\r\n\t\t\t\t\t\t//检测左边距是否在范围内\r\n\t\t\t\t\t\tif (this.cutX < 0) {\r\n\t\t\t\t\t\t\tthis.cutX = 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (this.cutX > this.sysInfo.windowWidth - this.canvasWidth) {\r\n\t\t\t\t\t\t\tthis.cutX = this.sysInfo.windowWidth - this.canvasWidth;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t//裁剪框坐标处理（如果只写一个参数则另一个默认为0，都不写默认居中）\r\n\t\t\t\tif (this.cutY == null && this.cutX == null) {\r\n\t\t\t\t\tlet cutY = (this.sysInfo.windowHeight - this.canvasHeight) * 0.5;\r\n\t\t\t\t\tlet cutX = (this.sysInfo.windowWidth - this.canvasWidth) * 0.5;\r\n\t\t\t\t\tthis.cutY = cutY; //截取的框上边距\r\n\t\t\t\t\tthis.cutX = cutX; //截取的框左边距\r\n\t\t\t\t} else if (this.cutY != null && this.cutX != null) {\r\n\t\t\t\t\tcutDetectionPositionTop();\r\n\t\t\t\t\tcutDetectionPositionLeft();\r\n\t\t\t\t} else if (this.cutY != null && this.cutX == null) {\r\n\t\t\t\t\tcutDetectionPositionTop();\r\n\t\t\t\t\tthis.cutX = (this.sysInfo.windowWidth - this.canvasWidth) / 2;\r\n\t\t\t\t} else if (this.cutY == null && this.cutX != null) {\r\n\t\t\t\t\tcutDetectionPositionLeft();\r\n\t\t\t\t\tthis.cutY = (this.sysInfo.windowHeight - this.canvasHeight) / 2;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 图片边缘检测-位置\r\n\t\t\t */\r\n\t\t\timgMarginDetectionPosition(scale) {\r\n\t\t\t\tif (!this.limitMove) return;\r\n\t\t\t\tlet left = this.imgLeft;\r\n\t\t\t\tlet top = this.imgTop;\r\n\t\t\t\tscale = scale || this.scale;\r\n\t\t\t\tlet imgWidth = this.imgWidth;\r\n\t\t\t\tlet imgHeight = this.imgHeight;\r\n\t\t\t\tif ((this.angle / 90) % 2) {\r\n\t\t\t\t\timgWidth = this.imgHeight;\r\n\t\t\t\t\timgHeight = this.imgWidth;\r\n\t\t\t\t}\r\n\t\t\t\tleft = this.cutX + (imgWidth * scale) / 2 >= left ? left : this.cutX + (imgWidth * scale) / 2;\r\n\t\t\t\tleft = this.cutX + this.canvasWidth - (imgWidth * scale) / 2 <= left ? left : this.cutX + this\r\n\t\t\t\t\t.canvasWidth - (\r\n\t\t\t\t\t\timgWidth * scale) / 2;\r\n\t\t\t\ttop = this.cutY + (imgHeight * scale) / 2 >= top ? top : this.cutY + (imgHeight * scale) / 2;\r\n\t\t\t\ttop = this.cutY + this.canvasHeight - (imgHeight * scale) / 2 <= top ? top : this.cutY + this\r\n\t\t\t\t\t.canvasHeight - (\r\n\t\t\t\t\t\timgHeight * scale) / 2;\r\n\t\t\t\tthis.imgLeft = left;\r\n\t\t\t\tthis.imgTop = top;\r\n\t\t\t\tthis.scale = scale;\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 图片边缘检测-缩放\r\n\t\t\t */\r\n\t\t\timgMarginDetectionScale(scale) {\r\n\t\t\t\tif (!this.limitMove) return;\r\n\t\t\t\tscale = scale || this.scale;\r\n\t\t\t\tlet imgWidth = this.imgWidth;\r\n\t\t\t\tlet imgHeight = this.imgHeight;\r\n\t\t\t\tif ((this.angle / 90) % 2) {\r\n\t\t\t\t\timgWidth = this.imgHeight;\r\n\t\t\t\t\timgHeight = this.imgWidth;\r\n\t\t\t\t}\r\n\t\t\t\tif (imgWidth * scale < this.canvasWidth) {\r\n\t\t\t\t\tscale = this.canvasWidth / imgWidth;\r\n\t\t\t\t}\r\n\t\t\t\tif (imgHeight * scale < this.canvasHeight) {\r\n\t\t\t\t\tscale = Math.max(scale, this.canvasHeight / imgHeight);\r\n\t\t\t\t}\r\n\t\t\t\tthis.imgMarginDetectionPosition(scale);\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 计算图片尺寸\r\n\t\t\t */\r\n\t\t\timgComputeSize(width, height) {\r\n\t\t\t\t//默认按图片最小边 = 对应裁剪框尺寸\r\n\t\t\t\tlet imgWidth = width,\r\n\t\t\t\t\timgHeight = height;\r\n\t\t\t\tif (imgWidth && imgHeight) {\r\n\t\t\t\t\tif (imgWidth / imgHeight > (this.canvasWidth || this.width) / (this.canvasHeight || this.height)) {\r\n\t\t\t\t\t\timgHeight = this.canvasHeight || this.height;\r\n\t\t\t\t\t\timgWidth = (width / height) * imgHeight;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\timgWidth = this.canvasWidth || this.width;\r\n\t\t\t\t\t\timgHeight = (height / width) * imgWidth;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlet sys = this.sysInfo || uni.getSystemInfoSync();\r\n\t\t\t\t\timgWidth = sys.windowWidth;\r\n\t\t\t\t\timgHeight = 0;\r\n\t\t\t\t}\r\n\t\t\t\tthis.imgWidth = imgWidth;\r\n\t\t\t\tthis.imgHeight = imgHeight;\r\n\t\t\t},\r\n\t\t\t//改变截取框大小\r\n\t\t\tcomputeCutSize() {\r\n\t\t\t\tif (this.canvasWidth > this.sysInfo.windowWidth) {\r\n\t\t\t\t\tthis.canvasWidth = this.sysInfo.windowWidth;\r\n\t\t\t\t} else if (this.canvasWidth + this.cutX > this.sysInfo.windowWidth) {\r\n\t\t\t\t\tthis.cutX = this.sysInfo.windowWidth - this.cutX;\r\n\t\t\t\t}\r\n\t\t\t\tif (this.canvasHeight > this.sysInfo.windowHeight) {\r\n\t\t\t\t\tthis.canvasHeight = this.sysInfo.windowHeight;\r\n\t\t\t\t} else if (this.canvasHeight + this.cutY > this.sysInfo.windowHeight) {\r\n\t\t\t\t\tthis.cutY = this.sysInfo.windowHeight - this.cutY;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t//开始触摸\r\n\t\t\tstart(e) {\r\n\t\t\t\tthis.flagEndTouch = false;\r\n\t\t\t\tif (e.touches.length == 1) {\r\n\t\t\t\t\t//单指拖动\r\n\t\t\t\t\tthis.touchRelative[0] = {\r\n\t\t\t\t\t\tx: e.touches[0].clientX - this.imgLeft,\r\n\t\t\t\t\t\ty: e.touches[0].clientY - this.imgTop\r\n\t\t\t\t\t};\r\n\t\t\t\t} else {\r\n\t\t\t\t\t//双指放大\r\n\t\t\t\t\tlet width = Math.abs(e.touches[0].clientX - e.touches[1].clientX);\r\n\t\t\t\t\tlet height = Math.abs(e.touches[0].clientY - e.touches[1].clientY);\r\n\t\t\t\t\tthis.touchRelative = [{\r\n\t\t\t\t\t\t\tx: e.touches[0].clientX - this.imgLeft,\r\n\t\t\t\t\t\t\ty: e.touches[0].clientY - this.imgTop\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tx: e.touches[1].clientX - this.imgLeft,\r\n\t\t\t\t\t\t\ty: e.touches[1].clientY - this.imgTop\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t];\r\n\t\t\t\t\tthis.hypotenuseLength = Math.sqrt(Math.pow(width, 2) + Math.pow(height, 2));\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tmoveThrottle() {\r\n\t\t\t\tif (this.sysInfo.platform == 'android') {\r\n\t\t\t\t\tclearTimeout(this.MOVE_THROTTLE);\r\n\t\t\t\t\tthis.MOVE_THROTTLE = setTimeout(() => {\r\n\t\t\t\t\t\tthis.MOVE_THROTTLE_FLAG = true;\r\n\t\t\t\t\t}, 800 / 40);\r\n\t\t\t\t\treturn this.MOVE_THROTTLE_FLAG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.MOVE_THROTTLE_FLAG = true;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tmove(e) {\r\n\t\t\t\tif (this.flagEndTouch || !this.MOVE_THROTTLE_FLAG) return;\r\n\t\t\t\tthis.MOVE_THROTTLE_FLAG = false;\r\n\t\t\t\tthis.moveThrottle();\r\n\t\t\t\tthis.moveDuring();\r\n\t\t\t\tif (e.touches.length == 1) {\r\n\t\t\t\t\t//单指拖动\r\n\t\t\t\t\tlet left = e.touches[0].clientX - this.touchRelative[0].x,\r\n\t\t\t\t\t\ttop = e.touches[0].clientY - this.touchRelative[0].y;\r\n\t\t\t\t\t//图像边缘检测,防止截取到空白\r\n\t\t\t\t\tthis.imgLeft = left;\r\n\t\t\t\t\tthis.imgTop = top;\r\n\t\t\t\t\tthis.imgMarginDetectionPosition();\r\n\t\t\t\t} else {\r\n\t\t\t\t\t//双指放大\r\n\t\t\t\t\tlet width = Math.abs(e.touches[0].clientX - e.touches[1].clientX),\r\n\t\t\t\t\t\theight = Math.abs(e.touches[0].clientY - e.touches[1].clientY),\r\n\t\t\t\t\t\thypotenuse = Math.sqrt(Math.pow(width, 2) + Math.pow(height, 2)),\r\n\t\t\t\t\t\tscale = this.scale * (hypotenuse / this.hypotenuseLength),\r\n\t\t\t\t\t\tcurrent_deg = 0;\r\n\t\t\t\t\tscale = scale <= this.minScale ? this.minScale : scale;\r\n\t\t\t\t\tscale = scale >= this.maxScale ? this.maxScale : scale;\r\n\t\t\t\t\t//图像边缘检测,防止截取到空白\r\n\t\t\t\t\t// this.scale = scale;\r\n\t\t\t\t\tthis.imgMarginDetectionScale(scale);\r\n\t\t\t\t\t//双指旋转(如果没禁用旋转)\r\n\t\t\t\t\tlet touchRelative = [{\r\n\t\t\t\t\t\t\tx: e.touches[0].clientX - this.imgLeft,\r\n\t\t\t\t\t\t\ty: e.touches[0].clientY - this.imgTop\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tx: e.touches[1].clientX - this.imgLeft,\r\n\t\t\t\t\t\t\ty: e.touches[1].clientY - this.imgTop\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t];\r\n\t\t\t\t\tif (!this.disableRotate) {\r\n\t\t\t\t\t\tlet first_atan = (180 / Math.PI) * Math.atan2(touchRelative[0].y, touchRelative[0].x);\r\n\t\t\t\t\t\tlet first_atan_old = (180 / Math.PI) * Math.atan2(this.touchRelative[0].y, this.touchRelative[0]\r\n\t\t\t\t\t\t.x);\r\n\t\t\t\t\t\tlet second_atan = (180 / Math.PI) * Math.atan2(touchRelative[1].y, touchRelative[1].x);\r\n\t\t\t\t\t\tlet second_atan_old = (180 / Math.PI) * Math.atan2(this.touchRelative[1].y, this.touchRelative[1]\r\n\t\t\t\t\t\t\t.x);\r\n\t\t\t\t\t\t//当前旋转的角度\r\n\t\t\t\t\t\tlet first_deg = first_atan - first_atan_old,\r\n\t\t\t\t\t\t\tsecond_deg = second_atan - second_atan_old;\r\n\t\t\t\t\t\tif (first_deg != 0) {\r\n\t\t\t\t\t\t\tcurrent_deg = first_deg;\r\n\t\t\t\t\t\t} else if (second_deg != 0) {\r\n\t\t\t\t\t\t\tcurrent_deg = second_deg;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.touchRelative = touchRelative;\r\n\t\t\t\t\tthis.hypotenuseLength = Math.sqrt(Math.pow(width, 2) + Math.pow(height, 2));\r\n\t\t\t\t\t//更新视图\r\n\t\t\t\t\tthis.angle = this.angle + current_deg;\r\n\t\t\t\t\tthis.scale = this.scale;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t//结束操作\r\n\t\t\tend(e) {\r\n\t\t\t\tthis.flagEndTouch = true;\r\n\t\t\t\tthis.moveStop();\r\n\t\t\t},\r\n\t\t\t//裁剪框处理\r\n\t\t\tcutTouchMove(e) {\r\n\t\t\t\tif (this.flagCutTouch && this.MOVE_THROTTLE_FLAG) {\r\n\t\t\t\t\tif (this.lockRatio && (this.lockWidth || this.lockHeight)) return;\r\n\t\t\t\t\t//节流\r\n\t\t\t\t\tthis.MOVE_THROTTLE_FLAG = false;\r\n\t\t\t\t\tthis.moveThrottle();\r\n\t\t\t\t\tlet width = this.canvasWidth,\r\n\t\t\t\t\t\theight = this.canvasHeight,\r\n\t\t\t\t\t\tcutY = this.cutY,\r\n\t\t\t\t\t\tcutX = this.cutX,\r\n\t\t\t\t\t\tsize_correct = () => {\r\n\t\t\t\t\t\t\twidth = width <= this.maxWidth ? (width >= this.minWidth ? width : this.minWidth) : this\r\n\t\t\t\t\t\t\t\t.maxWidth;\r\n\t\t\t\t\t\t\theight = height <= this.maxHeight ? (height >= this.minHeight ? height : this.minHeight) : this\r\n\t\t\t\t\t\t\t\t.maxHeight;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsize_inspect = () => {\r\n\t\t\t\t\t\t\tif ((width > this.maxWidth || width < this.minWidth || height > this.maxHeight || height < this\r\n\t\t\t\t\t\t\t\t\t.minHeight) &&\r\n\t\t\t\t\t\t\t\tthis.lockRatio) {\r\n\t\t\t\t\t\t\t\tsize_correct();\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tsize_correct();\r\n\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\theight = this.CUT_START.height + (this.CUT_START.corner > 1 && this.CUT_START.corner < 4 ? 1 : -1) * (\r\n\t\t\t\t\t\tthis.CUT_START\r\n\t\t\t\t\t\t.y - e.touches[0].clientY);\r\n\t\t\t\t\tswitch (this.CUT_START.corner) {\r\n\t\t\t\t\t\tcase 1:\r\n\t\t\t\t\t\t\twidth = this.CUT_START.width - this.CUT_START.x + e.touches[0].clientX;\r\n\t\t\t\t\t\t\tif (this.lockRatio) {\r\n\t\t\t\t\t\t\t\theight = width / (this.canvasWidth / this.canvasHeight);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (!size_inspect()) return;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\t\twidth = this.CUT_START.width - this.CUT_START.x + e.touches[0].clientX;\r\n\t\t\t\t\t\t\tif (this.lockRatio) {\r\n\t\t\t\t\t\t\t\theight = width / (this.canvasWidth / this.canvasHeight);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (!size_inspect()) return;\r\n\t\t\t\t\t\t\tcutY = this.CUT_START.cutY - (height - this.CUT_START.height);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 3:\r\n\t\t\t\t\t\t\twidth = this.CUT_START.width + this.CUT_START.x - e.touches[0].clientX;\r\n\t\t\t\t\t\t\tif (this.lockRatio) {\r\n\t\t\t\t\t\t\t\theight = width / (this.canvasWidth / this.canvasHeight);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (!size_inspect()) return;\r\n\t\t\t\t\t\t\tcutY = this.CUT_START.cutY - (height - this.CUT_START.height);\r\n\t\t\t\t\t\t\tcutX = this.CUT_START.cutX - (width - this.CUT_START.width);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 4:\r\n\t\t\t\t\t\t\twidth = this.CUT_START.width + this.CUT_START.x - e.touches[0].clientX;\r\n\t\t\t\t\t\t\tif (this.lockRatio) {\r\n\t\t\t\t\t\t\t\theight = width / (this.canvasWidth / this.canvasHeight);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (!size_inspect()) return;\r\n\t\t\t\t\t\t\tcutX = this.CUT_START.cutX - (width - this.CUT_START.width);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!this.lockWidth && !this.lockHeight) {\r\n\t\t\t\t\t\tthis.canvasWidth = width;\r\n\t\t\t\t\t\tthis.cutX = cutX;\r\n\t\t\t\t\t\tthis.canvasHeight = height;\r\n\t\t\t\t\t\tthis.cutY = cutY;\r\n\t\t\t\t\t} else if (!this.lockWidth) {\r\n\t\t\t\t\t\tthis.canvasWidth = width;\r\n\t\t\t\t\t\tthis.cutX = cutX;\r\n\t\t\t\t\t} else if (!this.lockHeight) {\r\n\t\t\t\t\t\tthis.canvasHeight = height;\r\n\t\t\t\t\t\tthis.cutY = cutY;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.imgMarginDetectionScale();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcutTouchStart(e) {\r\n\t\t\t\tlet currentX = e.touches[0].clientX;\r\n\t\t\t\tlet currentY = e.touches[0].clientY;\r\n\r\n\t\t\t\t/*\r\n\t\t\t\t * (右下-1 右上-2 左上-3 左下-4)\r\n\t\t\t\t * left_x [3,4]\r\n\t\t\t\t * top_y [2,3]\r\n\t\t\t\t * right_x [1,2]\r\n\t\t\t\t * bottom_y [1,4]\r\n\t\t\t\t */\r\n\t\t\t\tlet left_x1 = this.cutX - 24;\r\n\t\t\t\tlet left_x2 = this.cutX + 24;\r\n\r\n\t\t\t\tlet top_y1 = this.cutY - 24;\r\n\t\t\t\tlet top_y2 = this.cutY + 24;\r\n\r\n\t\t\t\tlet right_x1 = this.cutX + this.canvasWidth - 24;\r\n\t\t\t\tlet right_x2 = this.cutX + this.canvasWidth + 24;\r\n\r\n\t\t\t\tlet bottom_y1 = this.cutY + this.canvasHeight - 24;\r\n\t\t\t\tlet bottom_y2 = this.cutY + this.canvasHeight + 24;\r\n\r\n\t\t\t\tif (currentX > right_x1 && currentX < right_x2 && currentY > bottom_y1 && currentY < bottom_y2) {\r\n\t\t\t\t\tthis.moveDuring();\r\n\t\t\t\t\tthis.flagCutTouch = true;\r\n\t\t\t\t\tthis.flagEndTouch = true;\r\n\t\t\t\t\tthis.CUT_START = {\r\n\t\t\t\t\t\twidth: this.canvasWidth,\r\n\t\t\t\t\t\theight: this.canvasHeight,\r\n\t\t\t\t\t\tx: currentX,\r\n\t\t\t\t\t\ty: currentY,\r\n\t\t\t\t\t\tcorner: 1\r\n\t\t\t\t\t};\r\n\t\t\t\t} else if (currentX > right_x1 && currentX < right_x2 && currentY > top_y1 && currentY < top_y2) {\r\n\t\t\t\t\tthis.moveDuring();\r\n\t\t\t\t\tthis.flagCutTouch = true;\r\n\t\t\t\t\tthis.flagEndTouch = true;\r\n\t\t\t\t\tthis.CUT_START = {\r\n\t\t\t\t\t\twidth: this.canvasWidth,\r\n\t\t\t\t\t\theight: this.canvasHeight,\r\n\t\t\t\t\t\tx: currentX,\r\n\t\t\t\t\t\ty: currentY,\r\n\t\t\t\t\t\tcutY: this.cutY,\r\n\t\t\t\t\t\tcutX: this.cutX,\r\n\t\t\t\t\t\tcorner: 2\r\n\t\t\t\t\t};\r\n\t\t\t\t} else if (currentX > left_x1 && currentX < left_x2 && currentY > top_y1 && currentY < top_y2) {\r\n\t\t\t\t\tthis.moveDuring();\r\n\t\t\t\t\tthis.flagCutTouch = true;\r\n\t\t\t\t\tthis.flagEndTouch = true;\r\n\t\t\t\t\tthis.CUT_START = {\r\n\t\t\t\t\t\twidth: this.canvasWidth,\r\n\t\t\t\t\t\theight: this.canvasHeight,\r\n\t\t\t\t\t\tcutY: this.cutY,\r\n\t\t\t\t\t\tcutX: this.cutX,\r\n\t\t\t\t\t\tx: currentX,\r\n\t\t\t\t\t\ty: currentY,\r\n\t\t\t\t\t\tcorner: 3\r\n\t\t\t\t\t};\r\n\t\t\t\t} else if (currentX > left_x1 && currentX < left_x2 && currentY > bottom_y1 && currentY < bottom_y2) {\r\n\t\t\t\t\tthis.moveDuring();\r\n\t\t\t\t\tthis.flagCutTouch = true;\r\n\t\t\t\t\tthis.flagEndTouch = true;\r\n\t\t\t\t\tthis.CUT_START = {\r\n\t\t\t\t\t\twidth: this.canvasWidth,\r\n\t\t\t\t\t\theight: this.canvasHeight,\r\n\t\t\t\t\t\tcutY: this.cutY,\r\n\t\t\t\t\t\tcutX: this.cutX,\r\n\t\t\t\t\t\tx: currentX,\r\n\t\t\t\t\t\ty: currentY,\r\n\t\t\t\t\t\tcorner: 4\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcutTouchEnd(e) {\r\n\t\t\t\tthis.moveStop();\r\n\t\t\t\tthis.flagCutTouch = false;\r\n\t\t\t},\r\n\t\t\t//停止移动时需要做的操作\r\n\t\t\tmoveStop() {\r\n\t\t\t\t//清空之前的自动居中延迟函数并添加最新的\r\n\t\t\t\tclearTimeout(this.TIME_CUT_CENTER);\r\n\t\t\t\tthis.TIME_CUT_CENTER = setTimeout(() => {\r\n\t\t\t\t\t//动画启动\r\n\t\t\t\t\tif (!this.cutAnimation) {\r\n\t\t\t\t\t\tthis.cutAnimation = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.setCutCenter();\r\n\t\t\t\t}, 800);\r\n\t\t\t},\r\n\t\t\t//移动中\r\n\t\t\tmoveDuring() {\r\n\t\t\t\t//清空之前的自动居中延迟函数\r\n\t\t\t\tclearTimeout(this.TIME_CUT_CENTER);\r\n\t\t\t},\r\n\t\t\tshowLoading() {\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\t// #ifndef MP-ALIPAY\r\n\t\t\t\t\tmask: true,\r\n\t\t\t\t\t// #endif\r\n\t\t\t\t\ttitle: '请稍候...'\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tstop() {},\r\n\t\t\tback() {\r\n\t\t\t\tuni.navigateBack();\r\n\t\t\t},\r\n\t\t\tsetAngle() {\r\n\t\t\t\tthis.cutAnimation = true;\r\n\t\t\t\tthis.angle = this.angle + 90;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n</script>\r\n\r\n<style scoped>\r\n\t.tui-container {\r\n\t\twidth: 100vw;\r\n\t\theight: 100vh;\r\n\t\tpadding: 0;\r\n\t\tbackground-color: rgba(0, 0, 0, 0.6);\r\n\t\tposition: fixed;\r\n\t\ttop: 0;\r\n\t\tleft: 0;\r\n\t\tz-index: 1;\r\n\t}\r\n\r\n\t.tui-image-cropper {\r\n\t\twidth: 100vw;\r\n\t\theight: 100vh;\r\n\t\tposition: absolute;\r\n\t}\r\n\r\n\t.tui-content {\r\n\t\twidth: 100vw;\r\n\t\theight: 100vh;\r\n\t\tpadding: 0;\r\n\t\tposition: absolute;\r\n\t\tz-index: 9;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tpointer-events: none;\r\n\t}\r\n\r\n\t.tui-bg-transparent {\r\n\t\tbackground-color: rgba(0, 0, 0, 0.6);\r\n\t\ttransition-duration: 0.35s;\r\n\t}\r\n\r\n\t.tui-content-top {\r\n\t\tpointer-events: none;\r\n\t}\r\n\r\n\t.tui-content-middle {\r\n\t\twidth: 100%;\r\n\t\theight: 200px;\r\n\t\tdisplay: flex;\r\n\t\tbox-sizing: border-box;\r\n\t}\r\n\r\n\t.tui-cropper-box {\r\n\t\tposition: relative;\r\n\t\t/* transition-duration: 0.3s; */\r\n\t\tborder-style: solid;\r\n\t\tborder-width: 1rpx;\r\n\t\tbox-sizing: border-box;\r\n\t}\r\n\r\n\t.tui-flex-auto {\r\n\t\tflex: auto;\r\n\t}\r\n\r\n\t.tui-cropper-image {\r\n\t\twidth: 100%;\r\n\t\tborder-style: none;\r\n\t\tposition: absolute;\r\n\t\ttop: 0;\r\n\t\tleft: 0;\r\n\t\tz-index: 2;\r\n\t\t-webkit-backface-visibility: hidden;\r\n\t\tbackface-visibility: hidden;\r\n\t\ttransform-origin: center;\r\n\t}\r\n\r\n\t.tui-cropper__image-hidden {\r\n\t\topacity: 0;\r\n\t\tvisibility: hidden;\r\n\t}\r\n\r\n\t.tui-cropper-canvas {\r\n\t\tposition: fixed;\r\n\t\tz-index: 10;\r\n\t\tleft: -2000px;\r\n\t\ttop: -2000px;\r\n\t\tpointer-events: none;\r\n\t}\r\n\r\n\t.tui-edge {\r\n\t\tborder-style: solid;\r\n\t\tpointer-events: auto;\r\n\t\tposition: absolute;\r\n\t\tbox-sizing: border-box;\r\n\t}\r\n\r\n\t.tui-top-left {\r\n\t\tborder-bottom-width: 0 !important;\r\n\t\tborder-right-width: 0 !important;\r\n\t}\r\n\r\n\t.tui-top-right {\r\n\t\tborder-bottom-width: 0 !important;\r\n\t\tborder-left-width: 0 !important;\r\n\t}\r\n\r\n\t.tui-bottom-left {\r\n\t\tborder-top-width: 0 !important;\r\n\t\tborder-right-width: 0 !important;\r\n\t}\r\n\r\n\t.tui-bottom-right {\r\n\t\tborder-top-width: 0 !important;\r\n\t\tborder-left-width: 0 !important;\r\n\t}\r\n\r\n\t.tui-cropper-tabbar {\r\n\t\twidth: 100%;\r\n\t\theight: 120rpx;\r\n\t\tpadding: 0 40rpx;\r\n\t\tbox-sizing: border-box;\r\n\t\tposition: fixed;\r\n\t\tleft: 0;\r\n\t\tbottom: 0;\r\n\t\tz-index: 99;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: space-between;\r\n\t\tcolor: #ffffff;\r\n\t\tfont-size: 32rpx;\r\n\t}\r\n\r\n\t.tui-cropper-tabbar::after {\r\n\t\tcontent: ' ';\r\n\t\tposition: absolute;\r\n\t\ttop: 0;\r\n\t\tright: 0;\r\n\t\tleft: 0;\r\n\t\tborder-top: 1rpx solid rgba(255, 255, 255, 0.2);\r\n\t\t-webkit-transform: scaleY(0.5) translateZ(0);\r\n\t\ttransform: scaleY(0.5) translateZ(0);\r\n\t\ttransform-origin: 0 100%;\r\n\t}\r\n\r\n\t.tui-op-btn {\r\n\t\theight: 80rpx;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.tui-rotate-img {\r\n\t\twidth: 44rpx;\r\n\t\theight: 44rpx;\r\n\t}\r\n</style>\n","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./tui-image-cropper.vue?vue&type=style&index=0&id=080e3b74&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./tui-image-cropper.vue?vue&type=style&index=0&id=080e3b74&scoped=true&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1682554176364\n      var cssReload = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}